<!Doctype html>
<html>
  <head>
   
  </head>
  <body>
    <div id="react"></div>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/3.5.2/redux.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-redux/4.4.5/react-redux.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router/2.5.2/ReactRouter.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router-redux/4.0.5/ReactRouterRedux.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <script  type="text/babel">
        class DynamicMetas extends React.Component{
            constructor(props) {
                super(props);
                this.state={
                    metas:null
                }
            }
            componentDidMount() {
               
            var m = document.createElement('meta'); 
            m.name = 'title'; 
            m.content = 'React Life cycle'; 
            document.head.appendChild(m);
            m = document.createElement('meta'); 
            m.name = 'description'; 
            m.content = 'Understanding React Life cycle methods'; 
            document.head.appendChild(m);
            }
            render(){
                var { metas } = this.state;
                return ( <div> 
                    <NewComponent/>
                    </div> 
                )
            }
        }
   var NewComponent = React.createClass({
  render: function() {
    return (

      <div className="inner-content">
        <a className="edit-page-link" href="https://github.com/facebook/react/tree/master/docs/docs/state-and-lifecycle.md" target="_blank">Edit on GitHub</a>
        <h1>
          State and Lifecycle
        </h1>
        <div className="subHeader" />
        <p>Consider the ticking clock example from <a href="/react/docs/rendering-elements.html#updating-the-rendered-element">one of the previous sections</a>.</p>
        <p>So far we have only learned one way to update the UI.</p>
        <p>We call <code>ReactDOM.render()</code> to change the rendered output:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kd">function</span> <span className="nx">tick</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="kr">const</span> <span className="nx">element</span> <span className="o">=</span> <span className="p">(</span>{"\n"}{"    "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">new</span> <span className="nb">Date</span><span className="p">().</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}{"    "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"  "}<span className="p">);</span>{"\n"}<span className="hll">{"  "}<span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}</span><span className="hll">{"    "}<span className="nx">element</span><span className="p">,</span>{"\n"}</span><span className="hll">{"    "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}</span><span className="hll">{"  "}<span className="p">);</span>{"\n"}</span><span className="p">{"}"}</span>{"\n"}{"\n"}<span className="nx">setInterval</span><span className="p">(</span><span className="nx">tick</span><span className="p">,</span> <span className="mi">1000</span><span className="p">);</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/gwoJZk?editors=0010">Try it on CodePen.</a></p>
        <p>In this section, we will learn how to make the <code>Clock</code> component truly reusable and encapsulated. It will set up its own timer and update itself every second.</p>
        <p>We can start by encapsulating how the clock looks:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kd">function</span> <span className="nx">Clock</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="k">return</span> <span className="p">(</span>{"\n"}<span className="hll">{"    "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}</span><span className="hll">{"      "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}</span><span className="hll">{"      "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="nx">props</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}</span><span className="hll">{"    "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}</span>{"  "}<span className="p">);</span>{"\n"}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="kd">function</span> <span className="nx">tick</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}<span className="hll">{"    "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="nx">date</span><span className="o">=</span><span className="p">{"{"}</span><span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"}</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}</span>{"    "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}{"  "}<span className="p">);</span>{"\n"}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="nx">setInterval</span><span className="p">(</span><span className="nx">tick</span><span className="p">,</span> <span className="mi">1000</span><span className="p">);</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/dpdoYR?editors=0010">Try it on CodePen.</a></p>
        <p>However, it misses a crucial requirement: the fact that the <code>Clock</code> sets up a timer and updates the UI every second should be an implementation detail of the <code>Clock</code>.</p>
        <p>Ideally we want to write this once and have the <code>Clock</code> update itself:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}<span className="hll">{"  "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}</span>{"  "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}<span className="p">);</span>{"\n"}</code></pre></div>
        <p>To implement this, we need to add "state" to the <code>Clock</code> component.</p>
        <p>State is similar to props, but it is private and fully controlled by the component.</p>
        <p>We <a href="/react/docs/components-and-props.html#functional-and-class-components">mentioned before</a> that components defined as classes have some additional features. Local state is exactly that: a feature available only to classes.</p>
        <h2><a className="anchor" name="converting-a-function-to-a-class" />Converting a Function to a Class<a className="hash-link" href="#converting-a-function-to-a-class">#</a></h2>
        <p>You can convert a functional component like <code>Clock</code> to a class in five steps:</p>
        <ol>
          <li><p>Create an <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes">ES6 class</a> with the same name that extends <code>React.Component</code>.</p></li>
          <li><p>Add a single empty method to it called <code>render()</code>.</p></li>
          <li><p>Move the body of the function into the <code>render()</code> method.</p></li>
          <li><p>Replace <code>props</code> with <code>this.props</code> in the <code>render()</code> body.</p></li>
          <li><p>Delete the remaining empty function declaration.</p></li>
        </ol>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">props</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/zKRGpo?editors=0010">Try it on CodePen.</a></p>
        <p><code>Clock</code> is now defined as a class rather than a function.</p>
        <p>This lets us use additional features such as local state and lifecycle hooks.</p>
        <h2><a className="anchor" name="adding-local-state-to-a-class" />Adding Local State to a Class<a className="hash-link" href="#adding-local-state-to-a-class">#</a></h2>
        <p>We will move the <code>date</code> from props to state in three steps:</p>
        <p>1) Replace <code>this.props.date</code> with <code>this.state.date</code> in the <code>render()</code> method:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}<span className="hll">{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}</span>{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>2) Add a <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Classes#Constructor">class constructor</a> that assigns the initial <code>this.state</code>:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}<span className="hll">{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span><span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"};</span>{"\n"}</span>{"  "}<span className="p">{"}"}</span>{"\n"}{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>Note how we pass <code>props</code> to the base constructor:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js">{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}<span className="hll">{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}</span>{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span><span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"};</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>Class components should always call the base constructor with <code>props</code>.</p>
        <p>3) Remove the <code>date</code> prop from the <code>&lt;Clock /&gt;</code> element:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}<span className="hll">{"  "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}</span>{"  "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}<span className="p">);</span>{"\n"}</code></pre></div>
        <p>We will later add the timer code back to the component itself.</p>
        <p>The result looks like this:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}<span className="hll">{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}</span><span className="hll">{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}</span><span className="hll">{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span><span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"};</span>{"\n"}</span><span className="hll">{"  "}<span className="p">{"}"}</span>{"\n"}</span>{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}<span className="hll">{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}</span>{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}<span className="hll">{"  "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}</span>{"  "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}<span className="p">);</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/KgQpJd?editors=0010">Try it on CodePen.</a></p>
        <p>Next, we'll make the <code>Clock</code> set up its own timer and update itself every second.</p>
        <h2><a className="anchor" name="adding-lifecycle-methods-to-a-class" />Adding Lifecycle Methods to a Class<a className="hash-link" href="#adding-lifecycle-methods-to-a-class">#</a></h2>
        <p>In applications with many components, it's very important to free up resources taken by the components when they are destroyed.</p>
        <p>We want to <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval">set up a timer</a> whenever the <code>Clock</code> is rendered to the DOM for the first time. This is called "mounting" in React.</p>
        <p>We also want to <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/clearInterval">clear that timer</a> whenever the DOM produced by the <code>Clock</code> is removed. This is called "unmounting" in React.</p>
        <p>We can declare special methods on the component class to run some code when a component mounts and unmounts:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span><span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"};</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="hll">{"  "}<span className="nx">componentDidMount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}</span><span className="hll">{"\n"}</span><span className="hll">{"  "}<span className="p">{"}"}</span>{"\n"}</span>{"\n"}<span className="hll">{"  "}<span className="nx">componentWillUnmount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}</span><span className="hll">{"\n"}</span><span className="hll">{"  "}<span className="p">{"}"}</span>{"\n"}</span>{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>These methods are called "lifecycle hooks".</p>
        <p>The <code>componentDidMount()</code> hook runs after the component output has been rendered to the DOM. This is a good place to set up a timer:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js">{"  "}<span className="nx">componentDidMount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}<span className="hll">{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">timerID</span> <span className="o">=</span> <span className="nx">setInterval</span><span className="p">(</span>{"\n"}</span><span className="hll">{"      "}<span className="p">()</span> <span className="o">=&gt;</span> <span className="k">this</span><span className="p">.</span><span className="nx">tick</span><span className="p">(),</span>{"\n"}</span><span className="hll">{"      "}<span className="mi">1000</span>{"\n"}</span><span className="hll">{"    "}<span className="p">);</span>{"\n"}</span>{"  "}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>Note how we save the timer ID right on <code>this</code>.</p>
        <p>While <code>this.props</code> is set up by React itself and <code>this.state</code> has a special meaning, you are free to add additional fields to the class manually if you need to store something that is not used for the visual output.</p>
        <p>If you don't use something in <code>render()</code>, it shouldn't be in the state.</p>
        <p>We will tear down the timer in the <code>componentWillUnmount()</code> lifecycle hook:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js">{"  "}<span className="nx">componentWillUnmount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}<span className="hll">{"    "}<span className="nx">clearInterval</span><span className="p">(</span><span className="k">this</span><span className="p">.</span><span className="nx">timerID</span><span className="p">);</span>{"\n"}</span>{"  "}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>Finally, we will implement the <code>tick()</code> method that runs every second.</p>
        <p>It will use <code>this.setState()</code> to schedule updates to the component local state:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kr">class</span> <span className="nx">Clock</span> <span className="kr">extends</span> <span className="nx">React</span><span className="p">.</span><span className="nx">Component</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span><span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">(){"}"};</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}{"\n"}{"  "}<span className="nx">componentDidMount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">timerID</span> <span className="o">=</span> <span className="nx">setInterval</span><span className="p">(</span>{"\n"}{"      "}<span className="p">()</span> <span className="o">=&gt;</span> <span className="k">this</span><span className="p">.</span><span className="nx">tick</span><span className="p">(),</span>{"\n"}{"      "}<span className="mi">1000</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}{"\n"}{"  "}<span className="nx">componentWillUnmount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="nx">clearInterval</span><span className="p">(</span><span className="k">this</span><span className="p">.</span><span className="nx">timerID</span><span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="hll">{"  "}<span className="nx">tick</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}</span><span className="hll">{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">({"{"}</span>{"\n"}</span><span className="hll">{"      "}<span className="nx">date</span><span className="o">:</span> <span className="k">new</span> <span className="nb">Date</span><span className="p">()</span>{"\n"}</span><span className="hll">{"    "}<span className="p">{"}"});</span>{"\n"}</span><span className="hll">{"  "}<span className="p">{"}"}</span>{"\n"}</span>{"\n"}{"  "}<span className="nx">render</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h1</span><span className="o">&gt;</span><span className="nx">Hello</span><span className="p">,</span> <span className="nx">world</span><span className="o">!&lt;</span><span className="err">/h1&gt;</span>{"\n"}{"        "}<span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}{"      "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"    "}<span className="p">);</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}{"  "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}{"  "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}<span className="p">);</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/amqdNA?editors=0010">Try it on CodePen.</a></p>
        <p>Now the clock ticks every second.</p>
        <p>Let's quickly recap what's going on and the order in which the methods are called:</p>
        <p>1) When <code>&lt;Clock /&gt;</code> is passed to <code>ReactDOM.render()</code>, React calls the constructor of the <code>Clock</code> component. Since <code>Clock</code> needs to display the current time, it initializes <code>this.state</code> with an object including the current time. We will later update this state.</p>
        <p>2) React then calls the <code>Clock</code> component's <code>render()</code> method. This is how React learns what should be displayed on the screen. React then updates the DOM to match the <code>Clock</code>'s render output.</p>
        <p>3) When the <code>Clock</code> output is inserted in the DOM, React calls the <code>componentDidMount()</code> lifecycle hook. Inside it, the <code>Clock</code> component asks the browser to set up a timer to call <code>tick()</code> once a second.</p>
        <p>4) Every second the browser calls the <code>tick()</code> method. Inside it, the <code>Clock</code> component schedules a UI update by calling <code>setState()</code> with an object containing the current time. Thanks to the <code>setState()</code> call, React knows the state has changed, and calls <code>render()</code> method again to learn what should be on the screen. This time, <code>this.state.date</code> in the <code>render()</code> method will be different, and so the render output will include the updated time. React updates the DOM accordingly.</p>
        <p>5) If the <code>Clock</code> component is ever removed from the DOM, React calls the <code>componentWillUnmount()</code> lifecycle hook so the timer is stopped.</p>
        <h2><a className="anchor" name="using-state-correctly" />Using State Correctly<a className="hash-link" href="#using-state-correctly">#</a></h2>
        <p>There are three things you should know about <code>setState()</code>.</p>
        <h3><a className="anchor" name="do-not-modify-state-directly" />Do Not Modify State Directly<a className="hash-link" href="#do-not-modify-state-directly">#</a></h3>
        <p>For example, this will not re-render a component:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="c1">// Wrong</span>{"\n"}<span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">comment</span> <span className="o">=</span> <span className="s1">'Hello'</span><span className="p">;</span>{"\n"}</code></pre></div>
        <p>Instead, use <code>setState()</code>:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="c1">// Correct</span>{"\n"}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">({"{"}</span><span className="nx">comment</span><span className="o">:</span> <span className="s1">'Hello'</span><span className="p">{"}"});</span>{"\n"}</code></pre></div>
        <p>The only place where you can assign <code>this.state</code> is the constructor.</p>
        <h3><a className="anchor" name="state-updates-may-be-asynchronous" />State Updates May Be Asynchronous<a className="hash-link" href="#state-updates-may-be-asynchronous">#</a></h3>
        <p>React may batch multiple <code>setState()</code> calls into a single update for performance.</p>
        <p>Because <code>this.props</code> and <code>this.state</code> may be updated asynchronously, you should not rely on their values for calculating the next state.</p>
        <p>For example, this code may fail to update the counter:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="c1">// Wrong</span>{"\n"}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">({"{"}</span>{"\n"}{"  "}<span className="nx">counter</span><span className="o">:</span> <span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">counter</span> <span className="o">+</span> <span className="k">this</span><span className="p">.</span><span className="nx">props</span><span className="p">.</span><span className="nx">increment</span><span className="p">,</span>{"\n"}<span className="p">{"}"});</span>{"\n"}</code></pre></div>
        <p>To fix it, use a second form of <code>setState()</code> that accepts a function rather than an object. That function will receive the previous state as the first argument, and the props at the time the update is applied as the second argument:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="c1">// Correct</span>{"\n"}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">((</span><span className="nx">prevState</span><span className="p">,</span> <span className="nx">props</span><span className="p">)</span> <span className="o">=&gt;</span> <span className="p">({"{"}</span>{"\n"}{"  "}<span className="nx">counter</span><span className="o">:</span> <span className="nx">prevState</span><span className="p">.</span><span className="nx">counter</span> <span className="o">+</span> <span className="nx">props</span><span className="p">.</span><span className="nx">increment</span>{"\n"}<span className="p">{"}"}));</span>{"\n"}</code></pre></div>
        <p>We used an <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow function</a> above, but it also works with regular functions:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="c1">// Correct</span>{"\n"}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">(</span><span className="kd">function</span><span className="p">(</span><span className="nx">prevState</span><span className="p">,</span> <span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="k">return</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="nx">counter</span><span className="o">:</span> <span className="nx">prevState</span><span className="p">.</span><span className="nx">counter</span> <span className="o">+</span> <span className="nx">props</span><span className="p">.</span><span className="nx">increment</span>{"\n"}{"  "}<span className="p">{"}"};</span>{"\n"}<span className="p">{"}"});</span>{"\n"}</code></pre></div>
        <h3><a className="anchor" name="state-updates-are-merged" />State Updates are Merged<a className="hash-link" href="#state-updates-are-merged">#</a></h3>
        <p>When you call <code>setState()</code>, React merges the object you provide into the current state.</p>
        <p>For example, your state may contain several independent variables:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js">{"  "}<span className="nx">constructor</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="kr">super</span><span className="p">(</span><span className="nx">props</span><span className="p">);</span>{"\n"}{"    "}<span className="k">this</span><span className="p">.</span><span className="nx">state</span> <span className="o">=</span> <span className="p">{"{"}</span>{"\n"}<span className="hll">{"      "}<span className="nx">posts</span><span className="o">:</span> <span className="p">[],</span>{"\n"}</span><span className="hll">{"      "}<span className="nx">comments</span><span className="o">:</span> <span className="p">[]</span>{"\n"}</span>{"    "}<span className="p">{"}"};</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>Then you can update them independently with separate <code>setState()</code> calls:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js">{"  "}<span className="nx">componentDidMount</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"    "}<span className="nx">fetchPosts</span><span className="p">().</span><span className="nx">then</span><span className="p">(</span><span className="nx">response</span> <span className="o">=&gt;</span> <span className="p">{"{"}</span>{"\n"}{"      "}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">({"{"}</span>{"\n"}<span className="hll">{"        "}<span className="nx">posts</span><span className="o">:</span> <span className="nx">response</span><span className="p">.</span><span className="nx">posts</span>{"\n"}</span>{"      "}<span className="p">{"}"});</span>{"\n"}{"    "}<span className="p">{"}"});</span>{"\n"}{"\n"}{"    "}<span className="nx">fetchComments</span><span className="p">().</span><span className="nx">then</span><span className="p">(</span><span className="nx">response</span> <span className="o">=&gt;</span> <span className="p">{"{"}</span>{"\n"}{"      "}<span className="k">this</span><span className="p">.</span><span className="nx">setState</span><span className="p">({"{"}</span>{"\n"}<span className="hll">{"        "}<span className="nx">comments</span><span className="o">:</span> <span className="nx">response</span><span className="p">.</span><span className="nx">comments</span>{"\n"}</span>{"      "}<span className="p">{"}"});</span>{"\n"}{"    "}<span className="p">{"}"});</span>{"\n"}{"  "}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p>The merging is shallow, so <code>this.setState({'{'}comments{'}'})</code> leaves <code>this.state.posts</code> intact, but completely replaces <code>this.state.comments</code>.</p>
        <h2><a className="anchor" name="the-data-flows-down" />The Data Flows Down<a className="hash-link" href="#the-data-flows-down">#</a></h2>
        <p>Neither parent nor child components can know if a certain component is stateful or stateless, and they shouldn't care whether it is defined as a function or a class.</p>
        <p>This is why state is often called local or encapsulated. It is not accessible to any component other than the one that owns and sets it.</p>
        <p>A component may choose to pass its state down as props to its child components:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;</span>{"\n"}</code></pre></div>
        <p>This also works for user-defined components:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="o">&lt;</span><span className="nx">FormattedDate</span> <span className="nx">date</span><span className="o">=</span><span className="p">{"{"}</span><span className="k">this</span><span className="p">.</span><span className="nx">state</span><span className="p">.</span><span className="nx">date</span><span className="p">{"}"}</span> <span className="o">/&gt;</span>{"\n"}</code></pre></div>
        <p>The <code>FormattedDate</code> component would receive the <code>date</code> in its props and wouldn't know whether it came from the <code>Clock</code>'s state, from the <code>Clock</code>'s props, or was typed by hand:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kd">function</span> <span className="nx">FormattedDate</span><span className="p">(</span><span className="nx">props</span><span className="p">)</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="k">return</span> <span className="o">&lt;</span><span className="nx">h2</span><span className="o">&gt;</span><span className="nx">It</span> <span className="nx">is</span> <span className="p">{"{"}</span><span className="nx">props</span><span className="p">.</span><span className="nx">date</span><span className="p">.</span><span className="nx">toLocaleTimeString</span><span className="p">(){"}"}.</span><span className="o">&lt;</span><span className="err">/h2&gt;;</span>{"\n"}<span className="p">{"}"}</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/zKRqNB?editors=0010">Try it on CodePen.</a></p>
        <p>This is commonly called a "top-down" or "unidirectional" data flow. Any state is always owned by some specific component, and any data or UI derived from that state can only affect components "below" them in the tree.</p>
        <p>If you imagine a component tree as a waterfall of props, each component's state is like an additional water source that joins it at an arbitrary point but also flows down.</p>
        <p>To show that all components are truly isolated, we can create an <code>App</code> component that renders three <code>&lt;Clock&gt;</code>s:</p>
        <div className="highlight"><pre><code className="language-js" data-lang="js"><span className="kd">function</span> <span className="nx">App</span><span className="p">()</span> <span className="p">{"{"}</span>{"\n"}{"  "}<span className="k">return</span> <span className="p">(</span>{"\n"}{"    "}<span className="o">&lt;</span><span className="nx">div</span><span className="o">&gt;</span>{"\n"}<span className="hll">{"      "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span>{"\n"}</span><span className="hll">{"      "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span>{"\n"}</span><span className="hll">{"      "}<span className="o">&lt;</span><span className="nx">Clock</span> <span className="o">/&gt;</span>{"\n"}</span>{"    "}<span className="o">&lt;</span><span className="err">/div&gt;</span>{"\n"}{"  "}<span className="p">);</span>{"\n"}<span className="p">{"}"}</span>{"\n"}{"\n"}<span className="nx">ReactDOM</span><span className="p">.</span><span className="nx">render</span><span className="p">(</span>{"\n"}{"  "}<span className="o">&lt;</span><span className="nx">App</span> <span className="o">/&gt;</span><span className="p">,</span>{"\n"}{"  "}<span className="nb">document</span><span className="p">.</span><span className="nx">getElementById</span><span className="p">(</span><span className="s1">'root'</span><span className="p">)</span>{"\n"}<span className="p">);</span>{"\n"}</code></pre></div>
        <p><a href="http://codepen.io/gaearon/pen/vXdGmd?editors=0010">Try it on CodePen.</a></p>
        <p>Each <code>Clock</code> sets up its own timer and updates independently.</p>
        <p>In React apps, whether a component is stateful or stateless is considered an implementation detail of the component that may change over time. You can use stateless components inside stateful components, and vice versa.</p>
        <div className="docs-prevnext">
          <a className="docs-prev" href="/react/docs/components-and-props.html">← Prev</a>
          <a className="docs-next" href="/react/docs/handling-events.html">Next →</a>
        </div>
      </div>
    );
  }
});
      ReactDOM.render(
        <DynamicMetas/>,
        document.getElementById('react')
      );
    </script>
  </body>
</html>



<script>
  /*var m = document.createElement('meta'); 
  m.name = 'description'; 
  m.content = 'This tutorial has some helpful information for you, if you want to track how many hits come from browsers where JavaScript has been disabled.'; 
  document.head.appendChild(m);*/
</script>